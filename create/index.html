<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SapiBersinar: Buat Tugas</title>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-K5JQPNMVEF"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-K5JQPNMVEF'); // Your new GA4 Measurement ID
    </script>
    
    <!-- SEO Meta Tags for SapiBersinar Create Page -->
    <meta name="description" content="Buat link tugas unik Anda dengan SapiBersinar. Kustomisasi halaman tugas, tambahkan tugas, dan hasilkan link yang menarik untuk konten eksklusif atau promosi.">
    <meta name="keywords" content="buat link tugas, generator link, kustomisasi halaman, tugas media sosial, promosi online, SapiBersinar, alat creator, link monetisasi">
    <meta name="author" content="SapiBersinar">
    <meta name="robots" content="index, follow">

    <!-- Open Graph / Social Media Meta Tags (untuk berbagi di media sosial) -->
    <meta property="og:title" content="Buat Link Tugas Anda di SapiBersinar">
    <meta property="og:description" content="Buat link tugas unik Anda dengan SapiBersinar. Kustomisasi halaman tugas, tambahkan tugas, dan hasilkan link yang menarik untuk konten eksklusif atau promosi.">
    <meta property="og:url" content="https://sapibersinar.github.io/create/">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://placehold.co/1200x630/0d9488/ffffff?text=Buat+Link+Tugas"> <!-- Ganti dengan URL gambar logo/banner Anda -->
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800;900&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Custom Keyframes for Animations */
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        /* Animation for modal appearance */
        @keyframes scaleUp {
            from { transform: scale(0.95); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        /* New and improved animation for result section */
        @keyframes resultSectionPop {
            0% { transform: scale(0.9); opacity: 0; } /* Start slightly smaller and invisible */
            50% { transform: scale(1.02); opacity: 1; } /* Pop out slightly */
            100% { transform: scale(1); opacity: 1; } /* Settle to normal size */
        }


        .animate-fade-in-down { animation: fadeInDown 1s ease-out forwards; }
        .animate-fade-in-up { animation: fadeInUp 1s ease-out forwards; }
        .animate-fade-in { animation: fadeIn 0.8s ease-out forwards; }
        .animate-slide-in-right { animation: slideInRight 0.5s ease-out forwards; }
        .animate-pulse { animation: pulse 1.5s infinite ease-in-out; }
        .animate-scale-up { animation: scaleUp 0.3s ease-out forwards; }
        .animate-result-section-pop { animation: resultSectionPop 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards; } /* Springy effect */


        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s, color 0.3s;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align to top for longer content */
            min-height: 100vh;
            padding: 2rem 1.5rem; /* Increased top/bottom padding */
            box-sizing: border-box;
            /* Default theme handled by JS */
        }
        body.dark-theme {
            background: linear-gradient(135deg, #2c3e50 0%, #1a252f 100%); /* Darker, deep blue-gray gradient */
            color: #e2e8f0; /* gray-100 */
        }
        body.light-theme {
            background: linear-gradient(135deg, #f0fff4 0%, #e0ffe0 100%); /* Light pastel green gradient */
            color: #1a202c; /* gray-900 */
        }

        .main-card-container {
            border-radius: 1.75rem; /* rounded-3xl */
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15), 0 5px 15px rgba(0, 0, 0, 0.08); /* Deep, layered shadow */
            padding: 2.5rem; /* Generous padding */
            max-width: 900px; /* Wider max width */
            width: 100%;
            text-align: center;
            border: 1px solid #e0e0e0; /* Subtle light border */
            transition: background-color 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease; /* Smooth transition for theme change */
            animation: fadeIn 0.8s ease-out; /* Simple fade-in animation */
            position: relative;
            z-index: 2;
        }
        body.light-theme .main-card-container {
            background-color: #fdfcf5; /* Very light, warm cream/off-white */
            border-color: #e0e0e0;
        }
        body.dark-theme .main-card-container {
            background-color: #34495e; /* Darker blue-gray */
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3), 0 5px 15px rgba(0, 0, 0, 0.15); /* Darker shadow */
            border-color: #4a607a;
        }

        /* Button specific styles for theme */
        .btn-primary-dark {
            background: linear-gradient(to right, #8b5cf6, #6366f1); /* from-purple-600 to-indigo-600 */
            transition: all 0.3s ease;
        }
        .btn-primary-dark:hover {
            background: linear-gradient(to right, #7c3aed, #4f46e5); /* hover:from-purple-700 hover:to-indigo-700 */
            transform: scale(1.05);
        }

        .btn-primary-light {
            background: linear-gradient(to right, #3b82f6, #14b8a6); /* from-blue-500 to-teal-500 */
            transition: all 0.3s ease;
        }
        .btn-primary-light:hover {
            background: linear-gradient(to right, #2563eb, #0d9488); /* hover:from-blue-600 hover:to-teal-600 */
            transform: scale(1.05);
        }

        /* Input and Select styles */
        .input-field {
            padding: 0.75rem 1rem;
            border-radius: 0.75rem; /* rounded-xl */
            border: 1px solid #cbd5e0; /* light gray border */
            background-color: #ffffff;
            color: #1a202c;
            width: 100%;
            transition: all 0.2s ease-in-out;
        }
        body.dark-theme .input-field {
            background-color: #4a607a; /* Darker background for inputs */
            border-color: #607a8a;
            color: #e2e8f0;
        }
        .input-field:focus {
            outline: none;
            border-color: #6366f1; /* indigo-500 */
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.5); /* ring-indigo-500 */
        }
        .input-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            text-align: left;
        }
        .error-message {
            color: #ef4444; /* red-500 */
            font-size: 0.875rem; /* text-sm */
            margin-top: 0.25rem; /* mt-1 */
            text-align: left;
        }

        /* Task Card styles */
        .task-card {
            border-radius: 1rem; /* rounded-xl */
            padding: 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 1rem;
            text-align: left;
            transition: background-color 0.3s ease, border-color 0.3s ease; /* Ensure smooth color changes */
        }
        body.light-theme .task-card {
            background-color: #edf2f7; /* light gray */
            border: 1px solid #e2e8f0;
        }
        body.dark-theme .task-card {
            background-color: #2c3e50; /* darker blue-gray */
            border: 1px solid #4a607a;
        }

        /* Notification styles */
        #notificationContainer {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            pointer-events: none; /* Allows clicks to pass through */
        }
        .notification-item {
            background-color: #4CAF50; /* Green for success */
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            opacity: 0; /* Managed by JS for fade-in/out */
            transform: translateY(-100%); /* Managed by JS for slide-in/out */
            transition: opacity 0.3s ease-out, transform 0.3s ease-out; /* Smooth transition */
            min-width: 250px; /* Ensure it's wide enough for messages */
            text-align: left;
        }
        .notification-item.error {
            background-color: #f44336; /* Red for error */
        }
        .notification-item.dark-theme {
            background-color: #1abc9c; /* Teal for success in dark theme */
        }
        .notification-item.dark-theme.error {
            background-color: #e74c3c; /* Darker red for error in dark theme */
        }


        /* Toggle Button (copied from main page) */
        #darkModeToggle {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            background-color: #e0e0e0;
            color: #333;
            border: none;
            border-radius: 9999px;
            padding: 0.75rem;
            cursor: pointer;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease, color 0.3s ease, transform 0.2s ease;
            z-index: 10;
        }
        #darkModeToggle:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        body.dark-theme #darkModeToggle {
            background-color: #5A626F;
            color: #ecf0f1;
        }
        body.light-theme #darkModeToggle {
            background-color: #e0e0e0;
            color: #333;
        }

        /* Language Toggle Button (copied from main page) */
        #languageToggle {
            position: fixed;
            top: calc(1.5rem + 40px + 1rem);
            right: 1.5rem;
            background-color: #e0e0e0;
            color: #333;
            border: none;
            border-radius: 9999px;
            padding: 0.75rem 0.85rem;
            min-width: 40px;
            min-height: 40px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease, color 0.3s ease, transform 0.2s ease;
            z-index: 10;
        }
        #languageToggle:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        body.dark-theme #languageToggle {
            background-color: #5A626F;
            color: #ecf0f1;
        }
        body.light-theme #languageToggle {
            background-color: #e0e0e0;
            color: #333;
        }

        /* Responsive adjustments for smaller screens */
        @media (max-width: 640px) {
            body {
                padding: 1rem;
            }
            .main-card-container {
                padding: 1.5rem;
                border-radius: 1.25rem;
            }
            .title {
                font-size: 1.75rem;
            }
            .input-field {
                padding: 0.6rem 0.8rem;
                font-size: 0.9rem;
            }
            .input-label {
                font-size: 0.9rem;
            }
            .task-card {
                padding: 1rem;
            }
            #darkModeToggle, #languageToggle {
                top: 1rem;
                right: 1rem;
                padding: 0.6rem;
                font-size: 1rem;
            }
            #languageToggle {
                top: calc(1rem + 32px + 0.5rem);
                right: 1rem;
                padding: 0.6rem 0.8rem;
                min-width: 32px;
                min-height: 32px;
                font-size: 0.9rem;
            }
            /* Adjust task-item layout for small screens */
            .task-item > div:first-child { /* type select and error */
                width: 100%;
                margin-bottom: 0.5rem;
            }
            .task-item > div:nth-child(2) { /* action select and url input */
                width: 100%;
                margin-bottom: 0.5rem;
            }
        }
    </style>
</head>
<body class="dark-theme"> <!-- Default to dark-theme -->

    <!-- Dark Mode Toggle Button -->
    <button id="darkModeToggle" aria-label="Toggle dark mode" title="Ubah Tema">
        <i class="fas fa-sun"></i> <!-- Icon will be dynamically changed by JS -->
    </button>

    <!-- Language Toggle Button -->
    <button id="languageToggle" aria-label="Toggle language" title="Ubah Bahasa">
        EN <!-- Text will be dynamically changed by JS -->
    </button>

    <!-- Notification Container (for custom alerts) -->
    <div id="notificationContainer"></div>

    <div id="mainContent" class="main-card-container">
        <h1 id="pageTitle" class="text-4xl font-extrabold mb-8 animate-fade-in-down">Buat Link Tugas Baru</h1>

        <!-- Section for adding target URLs -->
        <div class="mb-8 p-6 rounded-xl shadow-md text-left task-card animate-fade-in" style="animation-delay: 0.2s;">
            <h2 id="targetUrlSectionTitle" class="text-2xl font-bold mb-4">Tambahkan URL Target (Maksimal 5)</h2>
            <div id="targetUrlsContainer" class="space-y-4 mb-4">
                <!-- Target URL inputs will be dynamically added here -->
            </div>
            <button id="addTargetUrlBtn" class="w-full py-3 rounded-xl font-bold text-white transition-all duration-300 transform hover:scale-105 btn-primary-dark">
                <i class="fas fa-plus mr-2"></i> <span id="addTargetUrlBtnText">Tambah URL Target</span>
            </button>
            <span id="targetUrlError" class="error-message hidden mt-2">Harap isi setidaknya satu URL target yang valid.</span>
        </div>

        <!-- Section for adding tasks -->
        <div class="mb-8 p-6 rounded-xl shadow-md text-left task-card animate-fade-in" style="animation-delay: 0.4s;">
            <h2 id="addTaskTitle" class="text-2xl font-bold mb-4">Tambahkan Tugas (Maksimal 5)</h2>
            <div id="tasksContainer" class="space-y-4 mb-4">
                <!-- Task items will be dynamically added here -->
            </div>
            <button id="addTaskBtn" class="w-full py-3 rounded-xl font-bold text-white transition-all duration-300 transform hover:scale-105 btn-primary-dark">
                <i class="fas fa-plus mr-2"></i> <span id="addTaskBtnText">Tambah Tugas</span>
            </button>
        </div>

        <!-- Section for required tasks count -->
        <div class="mb-8 p-6 rounded-xl shadow-md text-left task-card animate-fade-in" style="animation-delay: 0.6s;">
            <label for="requiredTasksCount" class="input-label" id="requiredTasksCountLabel">Jumlah Tugas yang Harus Diselesaikan:</label>
            <input type="number" id="requiredTasksCount" class="input-field" min="1" value="1" required>
            <p id="requiredTasksInfo" class="text-sm opacity-80 mt-2">Jumlah tugas yang harus diselesaikan oleh pengguna untuk membuka URL target. Harus lebih kecil atau sama dengan jumlah tugas yang ditambahkan.</p>
        </div>

        <!-- Section for Task Page Customization - Simplified -->
        <div class="mb-8 p-6 rounded-xl shadow-md text-left task-card animate-fade-in" style="animation-delay: 0.8s;">
            <h2 id="customizePageTitle" class="text-2xl font-bold mb-4">Kustomisasi Tampilan Halaman Tugas</h2>
            
            <div class="mb-4">
                <label for="colorScheme" class="input-label" id="colorSchemeLabel">Pilih Skema Warna:</label>
                <select id="colorScheme" class="input-field">
                    <!-- Options populated by JavaScript -->
                </select>
            </div>
        </div>

        <!-- Action Buttons: Generate and Reset -->
        <div class="mb-8 flex flex-col sm:flex-row gap-4 animate-fade-in-up" style="animation-delay: 1s;">
            <button id="generateLinkBtn" class="flex-1 px-8 py-4 text-xl font-bold rounded-full shadow-lg transform transition-all duration-300 hover:scale-105 focus:outline-none focus:ring-4 focus:ring-opacity-75 btn-primary-dark">
                <span class="relative z-10" id="generateLinkBtnText">Buat Link Tugas</span>
            </button>
            <button id="resetFormBtn" class="flex-1 px-8 py-4 text-xl font-bold rounded-full shadow-lg transform transition-all duration-300 hover:scale-105 focus:outline-none focus:ring-4 focus:ring-opacity-75 bg-gray-500 hover:bg-gray-600 text-white">
                <i class="fas fa-redo mr-2"></i> <span id="resetFormBtnText">Reset Formulir</span>
            </button>
        </div>

        <!-- Result Display and Copy -->
        <div id="resultSection" class="hidden p-6 rounded-xl shadow-md text-left task-card">
            <label for="generatedLink" class="input-label" id="generatedLinkLabel">Link Tugas Anda:</label>
            <textarea id="generatedLink" class="input-field mb-4 h-24 resize-none" readonly></textarea>
            <button id="copyLinkBtn" class="w-full py-3 rounded-xl font-bold text-white transition-all duration-300 transform hover:scale-105 btn-primary-dark">
                <i class="fas fa-copy mr-2"></i> <span id="copyLinkBtnText">Salin Link</span>
            </button>
        </div>
    </div>

    <!-- Custom Modal (Message Box) for validation errors) -->
    <div id="customModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden animate-fade-in">
        <div id="modalContent" class="p-8 rounded-xl shadow-2xl max-w-sm w-full text-center how-it-works-card-dark transform scale-95 animate-scale-up">
            <h3 id="modalTitle" class="text-2xl font-bold mb-4">Peringatan!</h3>
            <p id="modalMessage" class="text-lg mb-6">Pesan peringatan.</p>
            <button id="modalCloseBtn" class="px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 transform hover:scale-105 btn-primary-dark">
                Tutup
            </button>
        </div>
    </div>

    <script>
        // DOM Elements
        const body = document.body;
        const mainCardContainer = document.getElementById('mainContent');
        const toggleLanguageBtn = document.getElementById('languageToggle');
        const toggleThemeBtn = document.getElementById('darkModeToggle');
        const themeIcon = toggleThemeBtn.querySelector('i');

        const pageTitle = document.getElementById('pageTitle');
        
        const targetUrlSectionTitle = document.getElementById('targetUrlSectionTitle'); // New
        const targetUrlsContainer = document.getElementById('targetUrlsContainer'); // New
        const addTargetUrlBtn = document.getElementById('addTargetUrlBtn'); // New
        const addTargetUrlBtnText = document.getElementById('addTargetUrlBtnText'); // New
        const targetUrlError = document.getElementById('targetUrlError'); // Updated, now for multiple URLs

        const addTaskTitle = document.getElementById('addTaskTitle');
        const tasksContainer = document.getElementById('tasksContainer');
        const addTaskBtn = document.getElementById('addTaskBtn');
        const addTaskBtnText = document.getElementById('addTaskBtnText');
        const requiredTasksCountInput = document.getElementById('requiredTasksCount');
        const requiredTasksCountLabel = document.getElementById('requiredTasksCountLabel');
        const requiredTasksInfo = document.getElementById('requiredTasksInfo');
        const generateLinkBtn = document.getElementById('generateLinkBtn');
        const generateLinkBtnText = document.getElementById('generateLinkBtnText');
        const resetFormBtn = document.getElementById('resetFormBtn');
        const resetFormBtnText = document.getElementById('resetFormBtnText');
        const resultSection = document.getElementById('resultSection');
        const generatedLinkTextarea = document.getElementById('generatedLink');
        const generatedLinkLabel = document.getElementById('generatedLinkLabel');
        const copyLinkBtn = document.getElementById('copyLinkBtn');
        const copyLinkBtnText = document.getElementById('copyLinkBtnText');

        // Customization elements
        const customizePageTitle = document.getElementById('customizePageTitle');
        const colorSchemeSelect = document.getElementById('colorScheme');
        const colorSchemeLabel = document.getElementById('colorSchemeLabel');

        const customModal = document.getElementById('customModal');
        const modalContent = document.getElementById('modalContent');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');
        const modalCloseBtn = document.getElementById('modalCloseBtn');

        const notificationContainer = document.getElementById('notificationContainer');

        // Content for different languages
        const content = {
            id: {
                pageTitle: "Buat Link Tugas Baru",
                targetUrlSectionTitle: "Tambahkan URL Target (Maksimal 5)", // New
                addTargetUrlBtnText: "Tambah URL Target", // New
                targetUrlPlaceholder: "Contoh: https://link-tujuan-anda.com/konten-rahasia", // New
                targetUrlError: "Harap isi setidaknya satu URL target yang valid.", // Updated

                addTaskTitle: "Tambahkan Tugas (Maksimal 5)",
                addTaskBtnText: "Tambah Tugas",
                requiredTasksCountLabel: "Jumlah Tugas yang Harus Diselesaikan:",
                requiredTasksInfo: "Jumlah tugas yang harus diselesaikan oleh pengguna untuk membuka URL target. Harus lebih kecil atau sama dengan jumlah tugas yang ditambahkan.",
                generateLinkBtnText: "Buat Link Tugas",
                resetFormBtnText: "Reset Formulir",
                generatedLinkLabel: "Link Tugas Anda:",
                copyLinkBtnText: "Salin Link",
                taskTypes: {
                    tiktok: "TikTok",
                    whatsapp: "WhatsApp",
                    roblox: "Roblox",
                    youtube: "YouTube",
                    discord: "Discord",
                    blogger: "Blogger" // New task type
                },
                taskActions: { // New: Specific actions for each task type
                    youtube: {
                        subscribe: "Subscribe",
                        like: "Like",
                        watch: "Tonton"
                    },
                    roblox: {
                        follow: "Ikuti",
                        join: "Bergabung"
                    },
                    tiktok: {
                        like: "Like",
                        follow: "Follow"
                    },
                    // Blogger doesn't have specific actions, implicitly "visit"
                },
                taskPlaceholders: {
                    tiktok_follow: "Contoh: https://tiktok.com/@username",
                    tiktok_like: "Contoh: https://tiktok.com/@username/video/123456789",
                    whatsapp: "Contoh: https://wa.me/628123456789 atau https://whatsapp.com/channel/abcdef",
                    roblox_follow: "Contoh: https://roblox.com/users/12345/profile",
                    roblox_join: "Contoh: https://roblox.com/groups/12345/GroupName",
                    youtube_subscribe: "Contoh: https://youtube.com/channel/UC-ID",
                    youtube_like: "Contoh: https://youtube.com/watch?v=video_id",
                    youtube_watch: "Contoh: https://youtube.com/watch?v=video_id",
                    discord: "Contoh: https://discord.gg/invitecode",
                    blogger: "Contoh: https://nama-blog-anda.blogspot.com/post-tertentu" // New
                },
                buttonTextDefault: "Buka Konten Sekarang",
                modalWarningTitle: "Peringatan!",
                modalFillAllFields: "Harap isi semua kolom input yang diperlukan.",
                modalInvalidCount: "Jumlah tugas yang harus diselesaikan tidak valid. Harus antara 1 dan jumlah tugas yang ditambahkan.",
                modalNoTasks: "Harap tambahkan setidaknya satu tugas.",
                modalLinkCreated: "Link telah berhasil dibuat!",
                modalLinkCopied: "Link telah disalin!",
                inlineErrorTargetUrl: "URL target tidak boleh kosong.", // This will now be for individual target URLs
                inlineErrorTaskType: "Pilih jenis tugas.",
                inlineErrorTaskAction: "Pilih aksi tugas.", // New error message
                inlineErrorTaskUrl: "URL tugas tidak boleh kosong.",
                modalClose: "Tutup",
                toggleLanguageText: "EN",
                toggleThemeTitle: "Ubah Tema",
                formResetSuccess: "Formulir berhasil direset!",
                // Customization texts
                customizePageTitle: "Kustomisasi Tampilan Halaman Tugas",
                colorSchemeLabel: "Pilih Skema Warna:",
                colorSchemeOptions: {
                    default: "Default (Tema Aktif)",
                    modernBlue: "Modern Biru",
                    energeticGreen: "Hijau Energik",
                    vibrantPurple: "Ungu Cerah",
                    warmRed: "Merah Hangat",
                    coolGrey: "Abu-abu Sejuk"
                }
            },
            en: {
                pageTitle: "Create New Task Link",
                targetUrlSectionTitle: "Add Target URLs (Max 5)", // New
                addTargetUrlBtnText: "Add Target URL", // New
                targetUrlPlaceholder: "Example: https://your-destination-link.com/secret-content", // New
                targetUrlError: "Please enter at least one valid target URL.", // Updated

                addTaskTitle: "Add Task (Max 5)",
                addTaskBtnText: "Add Task",
                requiredTasksCountLabel: "Number of Tasks to Complete:",
                requiredTasksInfo: "The number of tasks users must complete to unlock the target URL. Must be less than or equal to the total tasks added.",
                generateLinkBtnText: "Generate Task Link",
                resetFormBtnText: "Reset Form",
                generatedLinkLabel: "Your Task Link:",
                copyLinkBtnText: "Copy Link",
                taskTypes: {
                    tiktok: "TikTok",
                    whatsapp: "WhatsApp",
                    roblox: "Roblox",
                    youtube: "YouTube",
                    discord: "Discord",
                    blogger: "Blogger" // New task type
                },
                taskActions: { // New: Specific actions for each task type
                    youtube: {
                        subscribe: "Subscribe",
                        like: "Like",
                        watch: "Watch"
                    },
                    roblox: {
                        follow: "Follow",
                        join: "Join"
                    },
                    tiktok: {
                        like: "Like",
                        follow: "Follow"
                    },
                    // Blogger doesn't have specific actions, implicitly "visit"
                },
                taskPlaceholders: {
                    tiktok_follow: "Example: https://tiktok.com/@username",
                    tiktok_like: "Example: https://tiktok.com/@username/video/123456789",
                    whatsapp: "Example: https://wa.me/1234567890 or https://whatsapp.com/channel/abcdef",
                    roblox_follow: "Example: https://roblox.com/users/12345/profile",
                    roblox_join: "Example: https://roblox.com/groups/12345/GroupName",
                    youtube_subscribe: "Example: https://youtube.com/channel/UC-ID",
                    youtube_like: "Example: https://youtube.com/watch?v=video_id",
                    youtube_watch: "Example: https://youtube.com/watch?v=video_id",
                    discord: "Example: https://discord.gg/invitecode",
                    blogger: "Example: https://your-blog-name.blogspot.com/specific-post" // New
                },
                buttonTextDefault: "Open Content Now",
                modalWarningTitle: "Warning!",
                modalFillAllFields: "Please fill in all required input fields.",
                modalInvalidCount: "Invalid number of tasks to complete. Must be between 1 and the number of tasks added.",
                modalNoTasks: "Please add at least one task.",
                modalLinkCreated: "Link successfully created!",
                modalLinkCopied: "Link copied!",
                inlineErrorTargetUrl: "Target URL cannot be empty.", // This will now be for individual target URLs
                inlineErrorTaskType: "Select a task type.",
                inlineErrorTaskAction: "Select a task action.", // New error message
                inlineErrorTaskUrl: "Task URL cannot be empty.",
                modalClose: "Close",
                toggleLanguageText: "ID",
                toggleThemeTitle: "Toggle Theme",
                formResetSuccess: "Form successfully reset!",
                // Customization texts
                customizePageTitle: "Customize Task Page Appearance",
                colorSchemeLabel: "Select Color Scheme:",
                colorSchemeOptions: {
                    default: "Default (Active Theme)",
                    modernBlue: "Modern Blue",
                    energeticGreen: "Energetic Green",
                    vibrantPurple: "Vibrant Purple",
                    warmRed: "Warm Red",
                    coolGrey: "Cool Grey"
                }
            }
        };


        // Initial state
        let currentLanguage = 'id';
        let currentTheme = 'dark'; // Default to dark theme for this page
        let taskCounter = 0; // To keep track of added tasks
        const MAX_TASKS = 5;
        let targetUrlCounter = 0; // New: To keep track of added target URLs
        const MAX_TARGET_URLS = 5; // New: Max target URLs

        // Colors for result section highlight (for light and dark theme) - back to blue/grey
        const resultColorsLight = [
            '#e0e8f0',
            '#d4e0e8',
            '#c8d8e0',
            '#bccbd4',
            '#b0bfc8'
        ];
        const resultColorsDark = [
            '#3a5369',
            '#425b74',
            '#4b637e',
            '#536c87',
            '#5b7590'
        ];
        let currentColorIndex = 0;

        // Function to populate customization select options
        function populateCustomizationOptions() {
            const currentLangOptions = content[currentLanguage].colorSchemeOptions;
            colorSchemeSelect.innerHTML = ''; // Clear existing options

            for (const key in currentLangOptions) {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = currentLangOptions[key];
                colorSchemeSelect.appendChild(option);
            }
        }

        // Function to update content based on language
        function updateContent() {
            const currentLangContent = content[currentLanguage];

            pageTitle.textContent = currentLangContent.pageTitle;
            
            targetUrlSectionTitle.textContent = currentLangContent.targetUrlSectionTitle; // New
            addTargetUrlBtnText.textContent = currentLangContent.addTargetUrlBtnText; // New
            targetUrlError.textContent = currentLangContent.targetUrlError; // Updated

            addTaskTitle.textContent = currentLangContent.addTaskTitle;
            addTaskBtnText.textContent = currentLangContent.addTaskBtnText;
            requiredTasksCountLabel.textContent = currentLangContent.requiredTasksCountLabel;
            requiredTasksInfo.textContent = currentLangContent.requiredTasksInfo;
            generateLinkBtnText.textContent = currentLangContent.generateLinkBtnText;
            resetFormBtnText.textContent = currentLangContent.resetFormBtnText;
            generatedLinkLabel.textContent = currentLangContent.generatedLinkLabel;
            copyLinkBtnText.textContent = currentLangContent.copyLinkBtnText;

            // Customization section texts
            customizePageTitle.textContent = currentLangContent.customizePageTitle;
            colorSchemeLabel.textContent = currentLangContent.colorSchemeLabel;

            // Repopulate customization options for selected language
            populateCustomizationOptions();
            // Ensure the previously selected value is maintained if available
            if (colorSchemeSelect.dataset.selected) {
                 colorSchemeSelect.value = colorSchemeSelect.dataset.selected;
            }

            // Language and Theme Toggle buttons
            toggleLanguageBtn.textContent = currentLangContent.toggleLanguageText;
            toggleLanguageBtn.title = currentLangContent.toggleLanguageText === 'EN' ? 'Switch to English' : 'Ubah ke Bahasa Indonesia';
            toggleThemeBtn.title = currentLangContent.toggleThemeTitle;

            // Update placeholders and labels for existing target URLs and tasks
            document.querySelectorAll('.target-url-input').forEach(input => { // New
                input.placeholder = currentLangContent.targetUrlPlaceholder;
            });

            document.querySelectorAll('.task-item').forEach(taskDiv => {
                const typeSelect = taskDiv.querySelector('.task-type-select');
                const actionSelect = taskDiv.querySelector('.task-action-select'); // New
                const urlInput = taskDiv.querySelector('.task-url-input');
                
                // Update task type options
                Array.from(typeSelect.options).forEach(option => {
                    if (option.value) {
                        option.textContent = currentLangContent.taskTypes[option.value];
                    } else {
                        option.textContent = currentLangContent.addTaskBtnText; // Default "Add Task" option
                    }
                });

                // Re-populate action options if actionSelect exists
                if (actionSelect) {
                    const selectedType = typeSelect.value;
                    if (selectedType && currentLangContent.taskActions[selectedType]) {
                        populateActionOptions(actionSelect, selectedType);
                        // Try to restore previously selected action
                        if (actionSelect.dataset.selected) {
                            actionSelect.value = actionSelect.dataset.selected;
                        }
                    }
                }
                
                // Update URL placeholder based on current type and action
                const selectedType = typeSelect.value;
                const selectedAction = actionSelect ? actionSelect.value : '';
                urlInput.placeholder = getTaskPlaceholder(selectedType, selectedAction);
            });

            // Inline error messages
            if (!targetUrlError.classList.contains('hidden')) {
                targetUrlError.textContent = currentLangContent.targetUrlError;
            }
            document.querySelectorAll('.task-item').forEach(taskDiv => {
                const typeError = taskDiv.querySelector('.task-type-error');
                const actionError = taskDiv.querySelector('.task-action-error'); // New
                const urlError = taskDiv.querySelector('.task-url-error');

                if (typeError && !typeError.classList.contains('hidden')) {
                    typeError.textContent = currentLangContent.inlineErrorTaskType;
                }
                if (actionError && !actionError.classList.contains('hidden')) {
                    actionError.textContent = currentLangContent.inlineErrorTaskAction; // New
                }
                if (urlError && !urlError.classList.contains('hidden')) {
                    urlError.textContent = currentLangContent.inlineErrorTaskUrl;
                }
            });
        }

        // Function to update theme classes and icon
        function updateTheme() {
            // Apply default theme to body and main card container
            body.classList.remove('dark-theme', 'light-theme');
            body.classList.add(`${currentTheme}-theme`);

            if (currentTheme === 'dark') {
                mainCardContainer.style.backgroundColor = '#34495e';
                mainCardContainer.style.borderColor = '#4a607a';
            } else {
                mainCardContainer.style.backgroundColor = '#fdfcf5';
                mainCardContainer.style.borderColor = '#e0e0e0';
            }

            // Update primary buttons
            document.querySelectorAll('.btn-primary-dark, .btn-primary-light').forEach(btn => {
                btn.classList.remove('btn-primary-dark', 'btn-primary-light');
                btn.classList.add(`btn-primary-${currentTheme}`);
            });

            // Update Reset button theme
            if (currentTheme === 'dark') {
                resetFormBtn.classList.remove('bg-gray-500', 'hover:bg-gray-600');
                resetFormBtn.classList.add('bg-gray-700', 'hover:bg-gray-800');
            } else {
                resetFormBtn.classList.remove('bg-gray-700', 'hover:bg-gray-800');
                resetFormBtn.classList.add('bg-gray-500', 'hover:bg-gray-600');
            }

            // Update input field classes
            document.querySelectorAll('.input-field').forEach(input => {
                if (currentTheme === 'dark') {
                    input.classList.add('dark-theme');
                } else {
                    input.classList.remove('dark-theme');
                }
            });

            // Update task card classes (used for all sections)
            document.querySelectorAll('.task-card').forEach(card => {
                if (currentTheme === 'dark') {
                    card.classList.add('dark-theme');
                    card.style.backgroundColor = '#2c3e50';
                    card.style.borderColor = '#4a607a';
                } else {
                    card.classList.remove('dark-theme');
                    card.style.backgroundColor = '#edf2f7';
                    card.style.borderColor = '#e2e8f0';
                }
            });

            // Update modal content background
            if (currentTheme === 'dark') {
                modalContent.classList.add('how-it-works-card-dark');
                modalContent.style.backgroundColor = '#2c3e50';
            } else {
                modalContent.classList.add('how-it-works-card-light');
                modalContent.style.backgroundColor = '#edf2f7';
            }

            // Update icon for theme toggle
            if (currentTheme === 'dark') {
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
            } else {
                themeIcon.classList.remove('fa-sun');
                themeIcon.classList.add('fa-moon');
            }

            updateContent(); 
        }

        // New: Function to add a new target URL input group
        function addTargetUrl() {
            if (targetUrlCounter >= MAX_TARGET_URLS) {
                showModal(content[currentLanguage].modalWarningTitle, `Anda hanya dapat menambahkan maksimal ${MAX_TARGET_URLS} URL target.`);
                return;
            }

            targetUrlCounter++;
            const targetUrlDiv = document.createElement('div');
            targetUrlDiv.className = `flex flex-col sm:flex-row items-center gap-2 mb-2 animate-slide-in-right`;

            targetUrlDiv.innerHTML = `
                <input type="url" class="input-field target-url-input flex-grow" placeholder="${content[currentLanguage].targetUrlPlaceholder}" required>
                <button type="button" class="remove-target-url-btn px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors mt-2 sm:mt-0">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            targetUrlsContainer.appendChild(targetUrlDiv);

            const newInputs = targetUrlDiv.querySelectorAll('.input-field');
            newInputs.forEach(input => {
                if (currentTheme === 'dark') {
                    input.classList.add('dark-theme');
                } else {
                    input.classList.remove('dark-theme');
                }
            });

            targetUrlDiv.querySelector('.remove-target-url-btn').addEventListener('click', () => {
                targetUrlsContainer.removeChild(targetUrlDiv);
                targetUrlCounter--;
                if (targetUrlCounter === 0) {
                    targetUrlError.classList.remove('hidden'); // Show error if no target URLs left
                }
            });

            // Hide error message if at least one URL is added
            if (targetUrlCounter > 0) {
                targetUrlError.classList.add('hidden');
            }
        }

        // New: Function to populate action options for a given task type
        function populateActionOptions(actionSelectElement, taskType) {
            actionSelectElement.innerHTML = ''; // Clear existing options
            const currentLangContent = content[currentLanguage];

            // Add default disabled option
            const defaultOption = document.createElement('option');
            defaultOption.value = "";
            defaultOption.disabled = true;
            defaultOption.selected = true;
            defaultOption.textContent = currentLangContent.inlineErrorTaskAction; // "Select a task action."
            actionSelectElement.appendChild(defaultOption);

            const actions = currentLangContent.taskActions[taskType];
            if (actions) {
                for (const actionKey in actions) {
                    const option = document.createElement('option');
                    option.value = actionKey;
                    option.textContent = actions[actionKey];
                    actionSelectElement.appendChild(option);
                }
            }
        }

        // New: Function to get dynamic placeholder for task URL
        function getTaskPlaceholder(taskType, taskAction) {
            const currentLangContent = content[currentLanguage];
            if (taskType === 'blogger') {
                return currentLangContent.taskPlaceholders.blogger;
            } else if (taskType && taskAction) {
                const key = `${taskType}_${taskAction}`;
                return currentLangContent.taskPlaceholders[key] || '';
            } else if (taskType) {
                // Fallback for cases where action is not yet selected, but type is
                return currentLangContent.taskPlaceholders[`${taskType}_${Object.keys(currentLangContent.taskActions[taskType] || {})[0]}`] || '';
            }
            return '';
        }

        // Function to add a new task input group
        function addTask() {
            if (taskCounter >= MAX_TASKS) {
                showModal(content[currentLanguage].modalWarningTitle, `Anda hanya dapat menambahkan maksimal ${MAX_TASKS} tugas.`);
                return;
            }

            taskCounter++;
            const taskId = `task-${taskCounter}`;
            const taskDiv = document.createElement('div');
            taskDiv.id = taskId;
            taskDiv.className = `task-item flex flex-col sm:flex-row items-start sm:items-center gap-2 mb-4 animate-slide-in-right`;

            if (currentTheme === 'dark') {
                taskDiv.classList.add('dark-theme');
                taskDiv.style.backgroundColor = '#2c3e50';
                taskDiv.style.borderColor = '#4a607a';
            } else {
                taskDiv.classList.remove('dark-theme');
                taskDiv.style.backgroundColor = '#edf2f7';
                taskDiv.style.borderColor = '#e2e8f0';
            }
            taskDiv.style.borderRadius = '1rem';
            taskDiv.style.padding = '1rem';
            taskDiv.style.boxShadow = '0 4px 10px rgba(0, 0, 0, 0.1)';


            const currentLangContent = content[currentLanguage];

            taskDiv.innerHTML = `
                <div class="flex flex-col w-full sm:w-1/4">
                    <select class="input-field task-type-select mb-1">
                        <option value="" disabled selected>${currentLangContent.inlineErrorTaskType}</option>
                        <option value="tiktok">${currentLangContent.taskTypes.tiktok}</option>
                        <option value="whatsapp">${currentLangContent.taskTypes.whatsapp}</option>
                        <option value="roblox">${currentLangContent.taskTypes.roblox}</option>
                        <option value="youtube">${currentLangContent.taskTypes.youtube}</option>
                        <option value="discord">${currentLangContent.taskTypes.discord}</option>
                        <option value="blogger">${currentLangContent.taskTypes.blogger}</option> <!-- New Blogger option -->
                    </select>
                    <span class="error-message task-type-error hidden">${currentLangContent.inlineErrorTaskType}</span>
                </div>
                <div class="flex flex-col flex-grow w-full sm:w-auto">
                    <select class="input-field task-action-select mt-2 sm:mt-0 mb-1 hidden"></select> <!-- Hidden by default -->
                    <span class="error-message task-action-error hidden">${currentLangContent.inlineErrorTaskAction}</span>
                    <input type="url" class="input-field task-url-input mt-2 sm:mt-0 mb-1" placeholder="" required>
                    <span class="error-message task-url-error hidden">${currentLangContent.inlineErrorTaskUrl}</span>
                </div>
                <button type="button" class="remove-task-btn px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors mt-2 sm:mt-0">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            tasksContainer.appendChild(taskDiv);

            const newInputs = taskDiv.querySelectorAll('.input-field');
            newInputs.forEach(input => {
                if (currentTheme === 'dark') {
                    input.classList.add('dark-theme');
                } else {
                    input.classList.remove('dark-theme');
                }
            });

            const typeSelect = taskDiv.querySelector('.task-type-select');
            const actionSelect = taskDiv.querySelector('.task-action-select');
            const urlInput = taskDiv.querySelector('.task-url-input');
            const typeError = taskDiv.querySelector('.task-type-error');
            const actionError = taskDiv.querySelector('.task-action-error');
            const urlError = taskDiv.querySelector('.task-url-error');

            taskDiv.querySelector('.remove-task-btn').addEventListener('click', () => {
                tasksContainer.removeChild(taskDiv);
                taskCounter--;
                updateRequiredTasksCountMax();
            });

            typeSelect.addEventListener('change', (e) => {
                const selectedType = e.target.value;
                typeError.classList.add('hidden'); // Hide type error

                // Reset and hide action select by default
                actionSelect.innerHTML = '';
                actionSelect.classList.add('hidden');
                actionSelect.value = ''; // Reset value
                actionSelect.dataset.selected = ''; // Clear stored selection
                actionError.classList.add('hidden'); // Hide action error

                // Update URL placeholder immediately
                urlInput.placeholder = getTaskPlaceholder(selectedType, ''); // Use empty action for initial placeholder

                if (selectedType === 'youtube' || selectedType === 'roblox' || selectedType === 'tiktok') {
                    populateActionOptions(actionSelect, selectedType);
                    actionSelect.classList.remove('hidden');
                    actionSelect.addEventListener('change', () => {
                        actionError.classList.add('hidden'); // Hide action error on change
                        // Update URL placeholder based on selected action
                        urlInput.placeholder = getTaskPlaceholder(selectedType, actionSelect.value);
                    });
                } else {
                    // For WhatsApp, Discord, Blogger, no action needed, implicitly "visit"
                    // Placeholder already set above
                }
            });

            urlInput.addEventListener('input', (e) => {
                urlError.classList.add('hidden');
            });

            updateRequiredTasksCountMax();
        }

        // Function to update the max attribute of requiredTasksCount input
        function updateRequiredTasksCountMax() {
            requiredTasksCountInput.max = taskCounter;
            if (parseInt(requiredTasksCountInput.value) > taskCounter) {
                requiredTasksCountInput.value = taskCounter;
            }
            if (taskCounter === 0) {
                requiredTasksCountInput.value = 0;
            } else if (requiredTasksCountInput.value < 1) {
                requiredTasksCountInput.value = 1;
            }
        }

        // Function to show custom modal (for validation errors, etc.)
        function showModal(title, message) {
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            customModal.classList.remove('hidden');
            if (currentTheme === 'dark') {
                modalContent.classList.add('how-it-works-card-dark');
                modalContent.style.backgroundColor = '#2c3e50';
            } else {
                modalContent.classList.add('how-it-works-card-light');
                modalContent.style.backgroundColor = '#edf2f7';
            }
        }

        // Function to show a temporary notification (toast/snackbar style)
        function showNotification(message, type = 'success', duration = 2100) {
            const notificationDiv = document.createElement('div');
            notificationDiv.className = `notification-item ${type} ${currentTheme === 'dark' ? 'dark-theme' : ''}`;
            notificationDiv.innerHTML = `
                <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-times-circle'}"></i>
                <span>${message}</span>
            `;

            notificationContainer.appendChild(notificationDiv);

            setTimeout(() => {
                notificationDiv.style.opacity = '1';
                notificationDiv.style.transform = 'translateY(0)';
            }, 10);

            setTimeout(() => {
                notificationDiv.style.opacity = '0';
                notificationDiv.style.transform = 'translateY(-100%)';
                notificationDiv.addEventListener('transitionend', function handler() {
                    notificationContainer.removeChild(notificationDiv);
                    notificationDiv.removeEventListener('transitionend', handler);
                });
            }, duration);
        }

        // Function to update the background color of the result section and trigger its animation
        function updateResultSectionColor(triggerAnimation = true) {
            const colors = currentTheme === 'dark' ? resultColorsDark : resultColorsLight;
            
            resultSection.style.backgroundColor = colors[currentColorIndex];
            
            if (triggerAnimation) {
                resultSection.classList.remove('animate-result-section-pop');
                void resultSection.offsetWidth; 
                resultSection.classList.add('animate-result-section-pop');
            }

            currentColorIndex = (currentColorIndex + 1) % colors.length;
        }

        // Function to clear all form fields and reset task counter
        function resetForm() {
            // Reset target URLs
            targetUrlsContainer.innerHTML = '';
            targetUrlCounter = 0;
            targetUrlError.classList.remove('hidden'); // Show error since no URLs exist initially

            tasksContainer.innerHTML = '';
            taskCounter = 0;
            requiredTasksCountInput.value = 1;
            updateRequiredTasksCountMax();
            resultSection.classList.add('hidden'); // Hide result section
            
            // Reset customization options to default
            colorSchemeSelect.value = 'default';
            colorSchemeSelect.dataset.selected = 'default';

            showNotification(content[currentLanguage].formResetSuccess, 'success');
        }

        // Function to validate URL format
        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (e) {
                return false;
            }
        }

        // Function to generate the task link
        function generateLink() {
            let isValid = true;
            const currentLangContent = content[currentLanguage];

            // Validate Target URLs
            const targets = [];
            const targetUrlInputs = document.querySelectorAll('.target-url-input');
            if (targetUrlInputs.length === 0) {
                targetUrlError.textContent = currentLangContent.targetUrlError;
                targetUrlError.classList.remove('hidden');
                isValid = false;
            } else {
                targetUrlInputs.forEach(input => {
                    const url = input.value.trim();
                    if (!url || !isValidUrl(url)) {
                        isValid = false;
                        input.classList.add('border-red-500', 'ring-red-500'); // Highlight invalid input
                        showModal(currentLangContent.modalWarningTitle, currentLangContent.targetUrlError);
                    } else {
                        input.classList.remove('border-red-500', 'ring-red-500');
                        targets.push(url);
                    }
                });
            }

            document.querySelectorAll('.task-item').forEach(taskDiv => {
                taskDiv.querySelector('.task-type-error').classList.add('hidden');
                taskDiv.querySelector('.task-action-error').classList.add('hidden'); // New
                taskDiv.querySelector('.task-url-error').classList.add('hidden');
            });

            const tasks = [];
            document.querySelectorAll('.task-item').forEach(taskDiv => {
                const typeSelect = taskDiv.querySelector('.task-type-select');
                const actionSelect = taskDiv.querySelector('.task-action-select');
                const urlInput = taskDiv.querySelector('.task-url-input');
                const typeError = taskDiv.querySelector('.task-type-error');
                const actionError = taskDiv.querySelector('.task-action-error'); // New
                const urlError = taskDiv.querySelector('.task-url-error');

                const type = typeSelect.value;
                let action = ''; // Default empty action
                if (type === 'blogger' || type === 'whatsapp' || type === 'discord') {
                    action = 'visit'; // Implicit action for these types
                } else if (actionSelect) {
                    action = actionSelect.value;
                }
                const url = urlInput.value.trim();

                if (!type) {
                    typeError.textContent = currentLangContent.inlineErrorTaskType;
                    typeError.classList.remove('hidden');
                    isValid = false;
                }
                // Validate action only if actionSelect is visible (meaning it's youtube, roblox, tiktok)
                if (actionSelect && !actionSelect.classList.contains('hidden') && !action) {
                    actionError.textContent = currentLangContent.inlineErrorTaskAction;
                    actionError.classList.remove('hidden');
                    isValid = false;
                }
                if (!url) {
                    urlError.textContent = currentLangContent.inlineErrorTaskUrl;
                    urlError.classList.remove('hidden');
                    isValid = false;
                } else if (!isValidUrl(url)) { // Validate task URL format as well
                    isValid = false;
                    urlError.textContent = currentLangContent.inlineErrorTaskUrl + " (format URL tidak valid)";
                    urlError.classList.remove('hidden');
                }
                tasks.push({ type, action, url }); // Store type, action, and url
            });

            if (tasks.length === 0) {
                showModal(currentLangContent.modalWarningTitle, currentLangContent.modalNoTasks);
                isValid = false;
            }

            const requiredTasks = parseInt(requiredTasksCountInput.value);
            if (isNaN(requiredTasks) || requiredTasks < 1 || requiredTasks > tasks.length) {
                showModal(currentLangContent.modalWarningTitle, currentLangContent.modalInvalidCount);
                isValid = false;
            }

            if (!isValid) {
                return null; // Return null if validation fails
            }

            const selectedColorScheme = colorSchemeSelect.value;

            const taskData = {
                targets: targets, // Now an array of URLs
                buttonText: currentLangContent.buttonTextDefault,
                requiredTasks: requiredTasks,
                tasks: tasks, // Tasks now include action
                custom: {
                    colorScheme: selectedColorScheme
                }
            };

            const encodedData = btoa(JSON.stringify(taskData));
            const generatedLink = `https://SapiBersinar.github.io/task/?data=${encodedData}`;

            return generatedLink;
        }

        // Function to copy the generated link
        function copyLink() {
            generatedLinkTextarea.select();
            document.execCommand('copy');
            showNotification(content[currentLanguage].modalLinkCopied, 'success');
        }

        // Event Listeners
        toggleLanguageBtn.addEventListener('click', () => {
            currentLanguage = currentLanguage === 'id' ? 'en' : 'id';
            updateContent();
            if (!resultSection.classList.contains('hidden')) {
                updateResultSectionColor(false);
            }
        });

        toggleThemeBtn.addEventListener('click', () => {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            updateTheme();
        });

        addTargetUrlBtn.addEventListener('click', addTargetUrl); // New event listener
        addTaskBtn.addEventListener('click', addTask);

        generateLinkBtn.addEventListener('click', () => {
            const link = generateLink(); // Generate final link, show errors
            if (link) {
                generatedLinkTextarea.value = link;
                resultSection.classList.remove('hidden'); // Show the result section
                updateResultSectionColor(true); // Trigger color animation for result section
                showNotification(content[currentLanguage].modalLinkCreated, 'success');
            } else {
                // If link generation failed, ensure result section is hidden
                resultSection.classList.add('hidden');
            }
        });
        resetFormBtn.addEventListener('click', resetForm);
        copyLinkBtn.addEventListener('click', copyLink);

        modalCloseBtn.addEventListener('click', () => {
            customModal.classList.add('hidden');
        });

        // Store selected color scheme on change to persist across language toggles
        colorSchemeSelect.addEventListener('change', () => {
            colorSchemeSelect.dataset.selected = colorSchemeSelect.value;
        });

        requiredTasksCountInput.addEventListener('input', updateRequiredTasksCountMax);

        // Initial setup
        populateCustomizationOptions();
        updateContent();
        updateTheme();
        updateRequiredTasksCountMax();
        addTargetUrl(); // Add one target URL input on load
    </script>
</body>
</html>

